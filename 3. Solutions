-- 1. The claims department wants to quickly look up customers from Toronto to check if theyâ€™ve submitted any claims this year. They first ask you to pull a simple list of those customers.
select
	full_name, email
from customers
where city = 'Toronto';
  
-- 2. The finance team is preparing a revenue report. They need to know how much premium money is collected from different types of policies to compare product performance.
select 
	policy_type, 
	sum(premium_amount) as total_premium 
from policies
group by policy_type
order by total_premium desc;
  
-- 3. Management is evaluating agent performance. For each agent, they want to see how many claims were handled on policies they wrote, and how many of those claims were approved or paid.
select 
a.full_name as agent_name, 
count(c.claim_id) as total_claims,
sum(case when c.status in ('approved','paid') then 1 else 0 end) as approved_or_paid_claims
from agents a

left join policies p on a.agent_id = p.agent_id
left join claims c on p.policy_id = c.policy_id

group by agent_name
order by total_claims desc;
